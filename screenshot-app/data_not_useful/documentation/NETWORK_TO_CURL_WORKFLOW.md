# ðŸ”„ Network Events â†’ cURL Commands Workflow

**Date**: 2025-11-08  
**Status**: âœ… COMPLETE WORKFLOW

---

## ðŸŽ¯ Complete Workflow

```
1. Capture Screenshot
   â†“
2. Network Events Captured (314 events)
   â†“
3. Convert to cURL Commands (102 API calls)
   â†“
4. Export as Shell Script
   â†“
5. Run, Test, Debug, Share
```

---

## ðŸ“Š Step-by-Step Process

### Step 1: Capture Screenshot
```bash
# Frontend sends request to capture screenshot
POST /api/screenshots/capture
{
  "url": "https://preprodapp.tekioncloud.com/accounting/accountingChain/list",
  "use_real_browser": true
}
```

### Step 2: Network Events Captured
```
ðŸ”— Active Tab Mode: Using your existing Chrome browser
   ðŸ“¡ Network listeners attached BEFORE page load
ðŸŒ Loading https://preprodapp.tekioncloud.com/accounting/accountingChain/list in new tab...
   âœ… Page loaded in new tab (network idle)
   ðŸ“¡ Network events captured during page load: 314
      ðŸŒ Network activity during page load (314 events):
         ðŸ“„ Document requests: 2
         ðŸ”„ XHR/Fetch requests: 102
         âŒ Failed requests: 32
```

### Step 3: Convert to cURL Commands
```
      ðŸ”— cURL commands (102 API calls):
         1. curl -X GET -H 'Authorization: Bearer ...' 'https://api.example.com/...'
         2. curl -X POST -H 'Content-Type: application/json' -d '{"key":"value"}' 'https://api.example.com/...'
         3. curl -X GET -H 'Authorization: Bearer ...' 'https://api.example.com/...'
         ... and 99 more
```

### Step 4: Export as Shell Script
```bash
# File: screenshots/curl_commands.sh
#!/bin/bash
# cURL commands exported from network events
# Generated by Screenshot Tool

# Request 1
curl -X GET -H 'Authorization: Bearer token123' 'https://api.example.com/accounting/chains'

# Request 2
curl -X POST -H 'Content-Type: application/json' -d '{"name":"New"}' 'https://api.example.com/data'

# Request 3
curl -X GET -H 'Authorization: Bearer token123' 'https://api.example.com/users'

... (99 more requests)
```

### Step 5: Run, Test, Debug, Share

#### Option A: Run All Commands
```bash
bash screenshots/curl_commands.sh
```

#### Option B: Run Individual Command
```bash
curl -X GET -H 'Authorization: Bearer token123' 'https://api.example.com/accounting/chains'
```

#### Option C: Debug with Verbose Output
```bash
curl -v -X GET -H 'Authorization: Bearer token123' 'https://api.example.com/accounting/chains'
```

#### Option D: Save Response to File
```bash
curl -X GET -H 'Authorization: Bearer token123' 'https://api.example.com/accounting/chains' > response.json
```

#### Option E: Share with Team
```bash
# Send curl_commands.sh to team members
# They can run the same API calls
```

---

## ðŸ” Data Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Screenshot Capture Request                               â”‚
â”‚    URL: https://preprodapp.tekioncloud.com/accounting/...   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. Browser Loads Page                                       â”‚
â”‚    - Attaches network listeners BEFORE page load            â”‚
â”‚    - Captures all network events                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. Network Events Captured (314 events)                     â”‚
â”‚    - 2 Document requests                                    â”‚
â”‚    - 102 XHR/Fetch requests                                 â”‚
â”‚    - 32 Failed requests                                     â”‚
â”‚    - Each with: URL, method, headers, post_data             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. Convert to cURL Commands                                 â”‚
â”‚    - Extract URL, method, headers, post_data                â”‚
â”‚    - Build cURL command string                              â”‚
â”‚    - Filter out document requests (keep API calls only)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. Export as Shell Script                                   â”‚
â”‚    - Save to: screenshots/curl_commands.sh                  â”‚
â”‚    - Include all 102 API calls                              â”‚
â”‚    - Add comments and formatting                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. Use cURL Commands                                        â”‚
â”‚    - Run manually in terminal                               â”‚
â”‚    - Run in shell script                                    â”‚
â”‚    - Debug API issues                                       â”‚
â”‚    - Test performance                                       â”‚
â”‚    - Share with team                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸ“‹ Example: Complete Workflow

### 1. Capture Screenshot
```bash
curl -X POST http://localhost:8000/api/screenshots/capture \
  -H 'Content-Type: application/json' \
  -d '{
    "url": "https://preprodapp.tekioncloud.com/accounting/accountingChain/list",
    "use_real_browser": true
  }'
```

### 2. See Network Events in Logs
```
ðŸ“¡ Network events captured during page load: 314
   ðŸŒ Network activity during page load (314 events):
      ðŸ“„ Document requests: 2
      ðŸ”„ XHR/Fetch requests: 102
      âŒ Failed requests: 32
      ðŸ”— cURL commands (102 API calls):
         1. curl -X GET -H 'Authorization: Bearer ...' 'https://api.example.com/...'
         2. curl -X POST -H 'Content-Type: application/json' -d '{"key":"value"}' 'https://api.example.com/...'
         ... and 100 more
```

### 3. Find Shell Script
```bash
ls -la screenshots/curl_commands.sh
# -rw-r--r--  1 user  staff  45678 Nov  8 12:34 screenshots/curl_commands.sh
```

### 4. Run All API Calls
```bash
bash screenshots/curl_commands.sh > api_responses.txt
```

### 5. Check Responses
```bash
cat api_responses.txt
# Shows all API responses
```

### 6. Debug Specific Call
```bash
# Run with verbose output
curl -v -X GET -H 'Authorization: Bearer token123' 'https://api.example.com/accounting/chains'

# Shows:
# > GET /api/accounting/chains HTTP/1.1
# > Authorization: Bearer token123
# < HTTP/1.1 200 OK
# < Content-Type: application/json
# {"data": [...]}
```

---

## ðŸŽ¯ Use Cases

### Use Case 1: Debug API Issues
```
Problem: Page shows no data
Solution:
1. Capture screenshot
2. Get cURL commands
3. Run individual API calls
4. See which one is failing
5. Debug the failing API
```

### Use Case 2: Test Performance
```
Problem: Page is slow
Solution:
1. Capture screenshot
2. Get cURL commands
3. Run with timing: curl -w "Time: %{time_total}s"
4. Identify slow API calls
5. Optimize slow endpoints
```

### Use Case 3: Share with Team
```
Problem: Team needs to test APIs
Solution:
1. Capture screenshot
2. Get cURL commands
3. Share curl_commands.sh with team
4. Team runs: bash curl_commands.sh
5. Everyone tests same API calls
```

### Use Case 4: Automate Testing
```
Problem: Need to test APIs regularly
Solution:
1. Capture screenshot
2. Get cURL commands
3. Save as curl_commands.sh
4. Add to CI/CD pipeline
5. Run automatically on every build
```

---

## ðŸ“Š Data Captured

### Network Event
```python
{
    'event': 'request',
    'type': 'xhr',
    'method': 'GET',
    'url': 'https://api.example.com/data?limit=50',
    'timestamp': 0.234,
    'headers': {
        'Authorization': 'Bearer token123',
        'Content-Type': 'application/json'
    },
    'post_data': None
}
```

### Converted to cURL
```bash
curl -X GET \
  -H 'Authorization: Bearer token123' \
  -H 'Content-Type: application/json' \
  'https://api.example.com/data?limit=50'
```

---

## âœ¨ Summary

**Workflow**: Capture â†’ Events â†’ cURL â†’ Test/Debug/Share

**Steps**:
1. Capture screenshot
2. Network events captured (314 events)
3. Convert to cURL commands (102 API calls)
4. Export as shell script
5. Run, test, debug, share

**Benefits**:
- âœ… Test APIs manually
- âœ… Debug issues
- âœ… Measure performance
- âœ… Share with team
- âœ… Automate testing

**Status**: âœ… Fully implemented and ready to use

---

## ðŸ“š Related Documents

- `NETWORK_EVENTS_TO_CURL.md` - How to export network events
- `CURL_COMMANDS_GUIDE.md` - cURL commands guide
- `NETWORK_EVENTS_EXPLAINED.md` - Network events overview

